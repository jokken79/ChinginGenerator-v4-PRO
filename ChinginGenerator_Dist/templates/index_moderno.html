<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ë≥ÉÈáëÂè∞Â∏≥ Generator v4.1 PRO - Modern UI</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');
        
        * {
            font-family: 'Inter', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .glass-morphism {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .gradient-text {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .hover-scale {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .hover-scale:hover {
            transform: translateY(-2px) scale(1.02);
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        
        .tab-active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .progress-glow {
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.5);
        }
        
        .terminal {
            background: #1a1a2e;
            color: #0f0;
            font-family: 'Fira Code', 'Consolas', monospace;
        }
        
        .floating {
            animation: float 3s ease-in-out infinite;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        
        .pulse {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }
        
        .gradient-border {
            background: linear-gradient(135deg, #667eea, #764ba2, #f093fb, #f5576c);
            background-size: 400% 400%;
            animation: gradient 15s ease infinite;
        }
        
        @keyframes gradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        .stat-card {
            background: linear-gradient(135deg, rgba(255,255,255,0.9), rgba(255,255,255,0.7));
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255,255,255,0.3);
        }
        
        .neon-text {
            text-shadow: 0 0 10px rgba(102, 126, 234, 0.8),
                         0 0 20px rgba(102, 126, 234, 0.6),
                         0 0 30px rgba(102, 126, 234, 0.4);
        }

        /* Fix para select/option - texto visible en dropdown */
        select option {
            background-color: #1a1a2e;
            color: #ffffff;
            padding: 10px;
        }

        select option:hover,
        select option:focus,
        select option:checked {
            background-color: #667eea;
            color: #ffffff;
        }

        /* Mejorar contraste de glassmorphism */
        .glass-morphism {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.25);
        }

        /* Stat cards con mejor contraste - texto oscuro sobre fondo claro */
        .stat-card {
            background: linear-gradient(135deg, rgba(255,255,255,0.95), rgba(255,255,255,0.9));
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255,255,255,0.5);
        }

        .stat-card p.text-sm {
            color: #4a5568 !important;
        }

        .stat-card .text-3xl {
            color: #1a202c !important;
        }

        /* Mejorar visibilidad de textos con baja opacidad */
        .glass-morphism p[class*="text-white/70"],
        .glass-morphism p[class*="text-white/80"],
        section p[class*="text-white/70"] {
            color: rgba(255, 255, 255, 0.95) !important;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
        }

        /* Inputs con mejor legibilidad */
        input[type="text"],
        select {
            background-color: rgba(255, 255, 255, 0.15) !important;
        }
    </style>
</head>
<body class="min-h-screen">
    <!-- Animated Background -->
    <div class="fixed inset-0 overflow-hidden pointer-events-none">
        <div class="absolute w-96 h-96 bg-purple-500 rounded-full opacity-10 blur-3xl -top-48 -left-48 floating"></div>
        <div class="absolute w-96 h-96 bg-blue-500 rounded-full opacity-10 blur-3xl -bottom-48 -right-48 floating" style="animation-delay: 1s;"></div>
        <div class="absolute w-64 h-64 bg-pink-500 rounded-full opacity-10 blur-2xl top-1/2 left-1/2 floating" style="animation-delay: 2s;"></div>
    </div>

    <!-- Header -->
    <header class="glass-morphism sticky top-0 z-50 border-b border-white/20">
        <div class="max-w-7xl mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center gap-4">
                    <div class="w-12 h-12 gradient-border rounded-xl flex items-center justify-center">
                        <i class="fas fa-chart-line text-white text-xl"></i>
                    </div>
                    <div>
                        <h1 class="text-2xl font-bold text-white">Ë≥ÉÈáëÂè∞Â∏≥ Generator</h1>
                        <p class="text-white/80 text-sm">v4.1 PRO - Modern UI</p>
                    </div>
                </div>
                <div class="flex items-center gap-4">
                    <div class="glass-morphism px-4 py-2 rounded-full">
                        <span class="text-white text-sm flex items-center gap-2">
                            <i class="fas fa-database text-green-400"></i>
                            BD Conectada
                        </span>
                    </div>
                    <div class="glass-morphism px-4 py-2 rounded-full">
                        <span id="recordCount" class="text-white text-sm">0 registros</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-6 py-8">
        <!-- Stats Dashboard -->
        <section class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
            <div class="stat-card rounded-2xl p-6 hover-scale">
                <div class="flex items-center justify-between mb-4">
                    <div class="w-12 h-12 bg-blue-500/20 rounded-xl flex items-center justify-center">
                        <i class="fas fa-users text-blue-600 text-xl"></i>
                    </div>
                    <div class="text-blue-600 text-sm font-medium">+12%</div>
                </div>
                <p class="text-white/70 text-sm mb-1">Empleados</p>
                <p id="statEmployees" class="text-3xl font-bold text-white">0</p>
                <div class="mt-3 h-1 bg-blue-500/30 rounded-full overflow-hidden">
                    <div class="h-full bg-blue-500 rounded-full" style="width: 75%;"></div>
                </div>
            </div>

            <div class="stat-card rounded-2xl p-6 hover-scale">
                <div class="flex items-center justify-between mb-4">
                    <div class="w-12 h-12 bg-green-500/20 rounded-xl flex items-center justify-center">
                        <i class="fas fa-file-alt text-green-600 text-xl"></i>
                    </div>
                    <div class="text-green-600 text-sm font-medium">+8%</div>
                </div>
                <p class="text-white/70 text-sm mb-1">Registros</p>
                <p id="statRecords" class="text-3xl font-bold text-white">0</p>
                <div class="mt-3 h-1 bg-green-500/30 rounded-full overflow-hidden">
                    <div class="h-full bg-green-500 rounded-full" style="width: 82%;"></div>
                </div>
            </div>

            <div class="stat-card rounded-2xl p-6 hover-scale">
                <div class="flex items-center justify-between mb-4">
                    <div class="w-12 h-12 bg-purple-500/20 rounded-xl flex items-center justify-center">
                        <i class="fas fa-calendar text-purple-600 text-xl"></i>
                    </div>
                    <div class="text-purple-600 text-sm font-medium">+15%</div>
                </div>
                <p class="text-white/70 text-sm mb-1">Periodos</p>
                <p id="statPeriods" class="text-3xl font-bold text-white">0</p>
                <div class="mt-3 h-1 bg-purple-500/30 rounded-full overflow-hidden">
                    <div class="h-full bg-purple-500 rounded-full" style="width: 68%;"></div>
                </div>
            </div>

            <div class="stat-card rounded-2xl p-6 hover-scale">
                <div class="flex items-center justify-between mb-4">
                    <div class="w-12 h-12 bg-orange-500/20 rounded-xl flex items-center justify-center">
                        <i class="fas fa-yen-sign text-orange-600 text-xl"></i>
                    </div>
                    <div class="text-orange-600 text-sm font-medium">+5%</div>
                </div>
                <p class="text-white/70 text-sm mb-1">Total Neto</p>
                <p id="statNetPay" class="text-3xl font-bold text-white">¬•0</p>
                <div class="mt-3 h-1 bg-orange-500/30 rounded-full overflow-hidden">
                    <div class="h-full bg-orange-500 rounded-full" style="width: 91%;"></div>
                </div>
            </div>
        </section>

        <!-- Navigation Tabs -->
        <nav class="glass-morphism rounded-2xl p-2 mb-8">
            <div class="flex flex-wrap gap-2">
                <button onclick="showTab('upload')" id="tab-upload" class="tab-active px-6 py-3 rounded-xl font-medium text-white transition-all duration-300 flex items-center gap-2">
                    <i class="fas fa-cloud-upload-alt"></i>
                    Subir Archivos
                </button>
                <button onclick="showTab('data')" id="tab-data" class="px-6 py-3 rounded-xl font-medium text-white/80 hover:text-white hover:bg-white/10 transition-all duration-300 flex items-center gap-2">
                    <i class="fas fa-database"></i>
                    Datos
                </button>
                <button onclick="showTab('export')" id="tab-export" class="px-6 py-3 rounded-xl font-medium text-white/80 hover:text-white hover:bg-white/10 transition-all duration-300 flex items-center gap-2">
                    <i class="fas fa-download"></i>
                    Exportar
                </button>
                <button onclick="showTab('chingin')" id="tab-chingin" class="px-6 py-3 rounded-xl font-medium text-white/80 hover:text-white hover:bg-white/10 transition-all duration-300 flex items-center gap-2">
                    <i class="fas fa-file-invoice"></i>
                    Ë≥ÉÈáëÂè∞Â∏≥
                </button>
                <button onclick="showTab('backup')" id="tab-backup" class="px-6 py-3 rounded-xl font-medium text-white/80 hover:text-white hover:bg-white/10 transition-all duration-300 flex items-center gap-2">
                    <i class="fas fa-shield-alt"></i>
                    Backup
                </button>
                <button onclick="showTab('audit')" id="tab-audit" class="px-6 py-3 rounded-xl font-medium text-white/80 hover:text-white hover:bg-white/10 transition-all duration-300 flex items-center gap-2">
                    <i class="fas fa-history"></i>
                    Auditor√≠a
                </button>
                <button onclick="showTab('settings')" id="tab-settings" class="px-6 py-3 rounded-xl font-medium text-white/80 hover:text-white hover:bg-white/10 transition-all duration-300 flex items-center gap-2">
                    <i class="fas fa-cog"></i>
                    Config
                </button>
            </div>
        </nav>

        <!-- Tab: Upload -->
        <section id="section-upload" class="tab-content">
            <div class="glass-morphism rounded-2xl p-8 mb-6">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-white flex items-center gap-3">
                        <i class="fas fa-cloud-upload-alt text-blue-400"></i>
                        Subir Archivos Âã§ÊÄ†Ë°®
                    </h2>
                    <button onclick="clearAllData()" class="bg-red-500/20 hover:bg-red-500/30 text-red-400 hover:text-red-300 px-6 py-3 rounded-xl font-medium transition-all duration-300 flex items-center gap-2">
                        <i class="fas fa-trash-alt"></i>
                        Borrar Todos los Datos
                    </button>
                </div>
                
                <div id="dropZone" class="border-3 border-dashed border-white/30 rounded-2xl p-12 text-center cursor-pointer hover:border-white/50 hover:bg-white/5 transition-all duration-300">
                    <div class="flex flex-col items-center gap-4">
                        <div class="w-20 h-20 bg-gradient-to-br from-blue-500 to-purple-600 rounded-2xl flex items-center justify-center floating">
                            <i class="fas fa-file-upload text-white text-3xl"></i>
                        </div>
                        <p class="text-white text-xl font-medium">„Éï„Ç°„Ç§„É´„Çí„Éâ„É©„ÉÉ„Ç∞ÔºÜ„Éâ„É≠„ÉÉ„Éó</p>
                        <p class="text-white/90">o haz clic para seleccionar</p>
                        <p class="text-white/90 text-sm mt-2">Formatos: .xlsm, .xlsx, .xls</p>
                    </div>
                    <input type="file" id="fileInput" multiple accept=".xlsm,.xlsx,.xls" class="hidden">
                </div>

                <!-- Progress Section -->
                <div id="progressSection" class="hidden">
                    <div class="glass-morphism rounded-2xl p-6">
                        <div class="flex justify-between items-center mb-4">
                            <span class="text-white font-medium text-lg" id="progressTitle">Procesando...</span>
                            <span class="text-white/80 text-lg" id="progressPercent">0%</span>
                        </div>
                        <div class="w-full bg-white/20 rounded-full h-6 overflow-hidden">
                            <div id="progressBar" class="bg-gradient-to-r from-blue-500 to-purple-600 h-6 rounded-full transition-all duration-500 progress-glow" style="width: 0%"></div>
                        </div>
                        <div class="mt-4 text-white/70 text-sm" id="progressDetails">
                            <!-- Progress details -->
                        </div>
                        <div id="progressLog" class="mt-4 max-h-64 overflow-y-auto terminal rounded-xl p-4 border border-white/20 hidden">
                            <div class="text-green-400 mb-2">$ chingin-processor --upload --modern-ui</div>
                            <!-- Terminal log -->
                        </div>
                    </div>
                </div>

                <div id="fileList" class="mt-6 space-y-3 hidden">
                    <h3 class="text-white text-lg font-medium mb-3 flex items-center gap-2">
                        <i class="fas fa-check-circle text-green-400"></i>
                        Archivos procesados:
                    </h3>
                    <div id="fileItems" class="space-y-2"></div>
                </div>
            </div>
        </section>

        <!-- Tab: Data -->
        <section id="section-data" class="tab-content hidden">
            <div class="glass-morphism rounded-2xl p-8">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-white flex items-center gap-3">
                        <i class="fas fa-database text-green-400"></i>
                        Datos de N√≥mina
                    </h2>
                    <div class="flex gap-3">
                        <button onclick="clearAllData()" class="bg-red-500/20 hover:bg-red-500/30 text-red-400 hover:text-red-300 px-6 py-3 rounded-xl font-medium transition-all duration-300 flex items-center gap-2">
                            <i class="fas fa-trash-alt"></i>
                            Borrar Todo
                        </button>
                        <button onclick="loadData()" class="bg-blue-500/20 hover:bg-blue-500/30 text-blue-400 hover:text-blue-300 px-6 py-3 rounded-xl font-medium transition-all duration-300 flex items-center gap-2">
                            <i class="fas fa-sync-alt"></i>
                            Actualizar
                        </button>
                    </div>
                </div>
                <div class="overflow-x-auto">
                    <div class="glass-morphism rounded-xl overflow-hidden">
                        <table class="w-full">
                            <thead class="bg-white/10">
                                <tr>
                                    <th class="px-6 py-4 text-left text-white font-medium">ÂæìÊ•≠Âì°Áï™Âè∑</th>
                                    <th class="px-6 py-4 text-left text-white font-medium">Ê∞èÂêç</th>
                                    <th class="px-6 py-4 text-left text-white font-medium">ÊîØÁµ¶ÂàÜ</th>
                                    <th class="px-6 py-4 text-right text-white font-medium">Á∑èÊîØÁµ¶È°ç</th>
                                    <th class="px-6 py-4 text-right text-white font-medium">ÊéßÈô§ÂêàË®à</th>
                                    <th class="px-6 py-4 text-right text-white font-medium">Â∑ÆÂºïÊîØÁµ¶È°ç</th>
                                </tr>
                            </thead>
                            <tbody id="dataTable" class="divide-y divide-white/10"></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>

        <!-- Tab: Export -->
        <section id="section-export" class="tab-content hidden">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="glass-morphism rounded-2xl p-8 text-center hover-scale">
                    <div class="w-16 h-16 bg-green-500/20 rounded-2xl flex items-center justify-center mx-auto mb-6">
                        <i class="fas fa-file-excel text-green-400 text-2xl"></i>
                    </div>
                    <h3 class="text-xl font-bold text-white mb-3">ALLÂá∫Âäõ</h3>
                    <p class="text-white/70 mb-6">Todos los datos consolidados</p>
                    <button onclick="exportAll()" class="w-full bg-gradient-to-r from-green-500 to-emerald-600 text-white py-4 rounded-xl font-semibold hover:shadow-lg transition-all duration-300 flex items-center justify-center gap-2">
                        <i class="fas fa-download"></i>
                        Descargar Excel
                    </button>
                </div>

                <div class="glass-morphism rounded-2xl p-8 text-center hover-scale">
                    <div class="w-16 h-16 bg-purple-500/20 rounded-2xl flex items-center justify-center mx-auto mb-6">
                        <i class="fas fa-calendar-alt text-purple-400 text-2xl"></i>
                    </div>
                    <h3 class="text-xl font-bold text-white mb-3">ÊúàÂà•ÂàÜÂâ≤</h3>
                    <p class="text-white/70 mb-6">Hojas separadas por mes</p>
                    <button onclick="exportMonthly()" class="w-full bg-gradient-to-r from-purple-500 to-pink-600 text-white py-4 rounded-xl font-semibold hover:shadow-lg transition-all duration-300 flex items-center justify-center gap-2">
                        <i class="fas fa-download"></i>
                        Descargar Excel
                    </button>
                </div>

                <div class="glass-morphism rounded-2xl p-8 text-center hover-scale">
                    <div class="w-16 h-16 bg-orange-500/20 rounded-2xl flex items-center justify-center mx-auto mb-6">
                        <i class="fas fa-file-invoice text-orange-400 text-2xl"></i>
                    </div>
                    <h3 class="text-xl font-bold text-white mb-3">Ë≥ÉÈáëÂè∞Â∏≥</h3>
                    <p class="text-white/70 mb-6">Un archivo por empleado</p>
                    <button onclick="exportChingin()" class="w-full bg-gradient-to-r from-orange-500 to-red-600 text-white py-4 rounded-xl font-semibold hover:shadow-lg transition-all duration-300 flex items-center justify-center gap-2">
                        <i class="fas fa-file-archive"></i>
                        Descargar ZIP
                    </button>
                </div>
            </div>
        </section>

        <!-- Tab: Chingin -->
        <section id="section-chingin" class="tab-content hidden">
            <div class="glass-morphism rounded-2xl p-8 mb-6">
                <h2 class="text-2xl font-bold text-white mb-6 flex items-center gap-3">
                    <i class="fas fa-file-invoice text-orange-400"></i>
                    Ë≥ÉÈáëÂè∞Â∏≥ - Generar por Empleado
                </h2>
                
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                    <div class="glass-morphism rounded-xl p-6">
                        <label class="block text-white font-medium mb-3 flex items-center gap-2">
                            <i class="fas fa-search text-blue-400"></i>
                            ÂæìÊ•≠Âì°Áï™Âè∑ (ID)
                        </label>
                        <input type="text" id="employeeIdInput" placeholder="Ej: 504010" 
                               class="w-full bg-white/10 border border-white/20 rounded-xl px-4 py-3 text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-300"
                               onkeypress="if(event.key==='Enter') searchEmployee()">
                    </div>
                    
                    <div class="glass-morphism rounded-xl p-6">
                        <label class="block text-white font-medium mb-3 flex items-center gap-2">
                            <i class="fas fa-calendar text-purple-400"></i>
                            Âπ¥Â∫¶
                        </label>
                        <select id="yearSelect" class="w-full bg-white/10 border border-white/20 rounded-xl px-4 py-3 text-white focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-all duration-300">
                            <option value="2025">2025</option>
                            <option value="2024">2024</option>
                            <option value="2023">2023</option>
                        </select>
                    </div>
                </div>
                
                <div class="flex gap-4">
                    <button onclick="searchEmployee()" class="flex-1 bg-gradient-to-r from-blue-500 to-purple-600 text-white py-4 rounded-xl font-semibold hover:shadow-lg transition-all duration-300 flex items-center justify-center gap-2">
                        <i class="fas fa-search"></i>
                        üîç Ê§úÁ¥¢ Buscar
                    </button>
                </div>
            </div>

            <!-- Employee Result -->
            <div id="employeeResult" class="hidden">
                <div class="glass-morphism rounded-2xl p-8 mb-6">
                    <div class="flex items-center justify-between mb-6">
                        <div>
                            <h3 class="text-2xl font-bold text-white" id="empName">-</h3>
                            <p class="text-white/70" id="empId">-</p>
                        </div>
                        <div class="text-right">
                            <p class="text-white/70 text-sm">Ê¥æÈÅ£ÂÖà</p>
                            <p class="text-white font-medium" id="empDispatch">-</p>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                        <div class="glass-morphism rounded-xl p-4">
                            <p class="text-white/70 text-sm mb-2">ÁôªÈå≤Êï∞</p>
                            <p class="text-2xl font-bold text-blue-400" id="empRecords">0</p>
                        </div>
                        <div class="glass-morphism rounded-xl p-4">
                            <p class="text-white/70 text-sm mb-2">ÂØæË±°ÊúüÈñì</p>
                            <p class="text-lg font-semibold text-green-400" id="empPeriods">-</p>
                        </div>
                        <div class="glass-morphism rounded-xl p-4">
                            <p class="text-white/70 text-sm mb-2">Ê∞èÂêç</p>
                            <p class="text-sm font-semibold text-purple-400" id="empKana">-</p>
                            <p class="text-sm font-semibold text-purple-300" id="empRoman">-</p>
                        </div>
                    </div>

                    <div class="flex gap-4">
                        <button onclick="generateChingin()" class="flex-1 bg-gradient-to-r from-green-500 to-emerald-600 text-white py-4 rounded-xl font-semibold hover:shadow-lg transition-all duration-300 flex items-center justify-center gap-2">
                            <i class="fas fa-download"></i>
                            üì• Ë≥ÉÈáëÂè∞Â∏≥„Çí„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ
                        </button>
                        <button onclick="previewChingin()" class="flex-1 bg-gradient-to-r from-purple-500 to-pink-600 text-white py-4 rounded-xl font-semibold hover:shadow-lg transition-all duration-300 flex items-center justify-center gap-2">
                            <i class="fas fa-eye"></i>
                            üëÅÔ∏è „Éó„É¨„Éì„É•„Éº Preview
                        </button>
                    </div>
                </div>
            </div>

            <!-- Not Found -->
            <div id="employeeNotFound" class="hidden">
                <div class="glass-morphism rounded-2xl p-12 text-center">
                    <div class="w-20 h-20 bg-red-500/20 rounded-2xl flex items-center justify-center mx-auto mb-6">
                        <i class="fas fa-user-slash text-red-400 text-3xl"></i>
                    </div>
                    <p class="text-red-400 font-medium text-xl mb-2">ÂæìÊ•≠Âì°„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì</p>
                    <p class="text-white/70">El empleado no fue encontrado en la base de datos</p>
                </div>
            </div>
        </section>

        <!-- Other tabs (Backup, Audit, Settings) - Simplified for modern UI -->
        <section id="section-backup" class="tab-content hidden">
            <div class="glass-morphism rounded-2xl p-8 text-center">
                <i class="fas fa-shield-alt text-6xl text-blue-400 mb-6"></i>
                <h2 class="text-2xl font-bold text-white mb-4">Backup System</h2>
                <p class="text-white/70 mb-6">Gesti√≥n de backups y restauraci√≥n</p>
                <button onclick="createBackup()" class="bg-gradient-to-r from-blue-500 to-purple-600 text-white py-4 px-8 rounded-xl font-semibold hover:shadow-lg transition-all duration-300">
                    <i class="fas fa-plus mr-2"></i>Crear Backup
                </button>
            </div>
        </section>

        <section id="section-audit" class="tab-content hidden">
            <div class="glass-morphism rounded-2xl p-8 text-center">
                <i class="fas fa-history text-6xl text-green-400 mb-6"></i>
                <h2 class="text-2xl font-bold text-white mb-4">Audit Log</h2>
                <p class="text-white/70 mb-6">Historial de auditor√≠a del sistema</p>
                <button onclick="loadAudit()" class="bg-gradient-to-r from-green-500 to-emerald-600 text-white py-4 px-8 rounded-xl font-semibold hover:shadow-lg transition-all duration-300">
                    <i class="fas fa-list mr-2"></i>Ver Auditor√≠a
                </button>
            </div>
        </section>

        <section id="section-settings" class="tab-content hidden">
            <div class="glass-morphism rounded-2xl p-8 text-center">
                <i class="fas fa-cog text-6xl text-purple-400 mb-6 pulse"></i>
                <h2 class="text-2xl font-bold text-white mb-4">Settings</h2>
                <p class="text-white/70 mb-6">Configuraci√≥n del sistema</p>
                <button onclick="loadSettings()" class="bg-gradient-to-r from-purple-500 to-pink-600 text-white py-4 px-8 rounded-xl font-semibold hover:shadow-lg transition-all duration-300">
                    <i class="fas fa-sliders-h mr-2"></i>Abrir Configuraci√≥n
                </button>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="glass-morphism mt-12 border-t border-white/20">
        <div class="max-w-7xl mx-auto px-6 py-6">
            <div class="flex justify-between items-center">
                <p class="text-white/70 text-sm">¬© 2025 Ë≥ÉÈáëÂè∞Â∏≥ Generator v4.1 PRO</p>
                <div class="flex items-center gap-4">
                    <span class="text-white/70 text-sm flex items-center gap-2">
                        <i class="fas fa-bolt text-yellow-400"></i>
                        Optimized Performance
                    </span>
                    <span class="text-white/70 text-sm flex items-center gap-2">
                        <i class="fas fa-robot text-blue-400"></i>
                        AI Powered
                    </span>
                </div>
            </div>
        </div>
    </footer>

    <script>
        // Modern UI JavaScript
        const apiCache = {
            data: {},
            ttl: 60000,
            get(key) {
                const cached = this.data[key];
                if (cached && (Date.now() - cached.timestamp < this.ttl)) {
                    return cached.value;
                }
                return null;
            },
            set(key, value) {
                this.data[key] = {
                    value: value,
                    timestamp: Date.now()
                };
            },
            clear() {
                this.data = {};
            }
        };

        // Tab navigation
        function showTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(el => el.classList.add('hidden'));
            document.querySelectorAll('[id^="tab-"]').forEach(el => el.classList.remove('tab-active'));
            document.getElementById('section-' + tabName).classList.remove('hidden');
            document.getElementById('tab-' + tabName).classList.add('tab-active');
            
            if (tabName === 'data') loadData();
            if (tabName === 'audit') loadAudit();
            if (tabName === 'settings') loadSettings();
        }

        // File upload
        const dropZone = document.getElementById('dropZone');
        const fileInput = document.getElementById('fileInput');

        dropZone.addEventListener('click', () => fileInput.click());
        dropZone.addEventListener('dragover', (e) => { 
            e.preventDefault(); 
            dropZone.classList.add('border-white/70', 'bg-white/10'); 
        });
        dropZone.addEventListener('dragleave', () => { 
            dropZone.classList.remove('border-white/70', 'bg-white/10'); 
        });
        dropZone.addEventListener('drop', (e) => {
            e.preventDefault();
            dropZone.classList.remove('border-white/70', 'bg-white/10');
            handleFiles(e.dataTransfer.files);
        });
        fileInput.addEventListener('change', (e) => handleFiles(e.target.files));

        async function handleFiles(files) {
            if (!files || files.length === 0) {
                showNotification('Por favor selecciona al menos un archivo', 'error');
                return;
            }

            const totalFiles = files.length;
            const progressSection = document.getElementById('progressSection');
            const progressBar = document.getElementById('progressBar');
            const progressPercent = document.getElementById('progressPercent');
            const progressTitle = document.getElementById('progressTitle');
            const progressDetails = document.getElementById('progressDetails');
            const progressLog = document.getElementById('progressLog');

            // Reset progress
            progressBar.style.width = '0%';
            progressBar.classList.remove('bg-gradient-to-r', 'from-green-500', 'to-emerald-600');
            progressBar.classList.add('bg-gradient-to-r', 'from-blue-500', 'to-purple-600');
            progressPercent.textContent = '0%';
            progressTitle.textContent = 'üöÄ Iniciando procesamiento...';
            progressDetails.textContent = '';
            
            // Show progress
            progressSection.classList.remove('hidden');
            progressLog.classList.remove('hidden');
            progressLog.innerHTML = '';

            const formData = new FormData();
            for (let file of files) {
                formData.append('files', file);
            }

            // Enhanced terminal logging
            const addLog = (msg, type = 'info') => {
                const colors = { 
                    info: 'text-green-400', 
                    success: 'text-green-300', 
                    error: 'text-red-400', 
                    warning: 'text-yellow-400',
                    cmd: 'text-cyan-400'
                };
                const icons = {
                    info: '   ',
                    success: ' ‚úì ',
                    error: ' ‚úó ',
                    warning: ' ‚ö† ',
                    cmd: ' $ '
                };
                const time = new Date().toLocaleTimeString('ja-JP', {hour: '2-digit', minute: '2-digit', second: '2-digit'});
                const icon = icons[type] || '   ';
                progressLog.innerHTML += `<div class="${colors[type]}"><span class="text-gray-500">[${time}]</span>${icon}${msg}</div>`;
                progressLog.scrollTop = progressLog.scrollHeight;
            };

            // Simulated progress with modern UI
            addLog('chingin-processor v4.1.0 --modern-ui', 'cmd');
            addLog('Processing files with enhanced performance...', 'info');

            try {
                const response = await fetch('/api/upload', { method: 'POST', body: formData });
                const data = await response.json();

                if (!response.ok) {
                    throw new Error(`Error HTTP: ${response.status}`);
                }

                // Success animation
                progressBar.classList.remove('from-blue-500', 'to-purple-600');
                progressBar.classList.add('from-green-500', 'to-emerald-600');
                progressTitle.textContent = '‚úÖ Procesamiento completado exitosamente';
                progressPercent.textContent = '100%';

                addLog('All files processed successfully!', 'success');
                addLog('Database updated with performance optimizations', 'info');

                // Show results
                document.getElementById('fileList').classList.remove('hidden');
                const fileItems = document.getElementById('fileItems');
                fileItems.innerHTML = data.results.map(r => `
                    <div class="glass-morphism rounded-xl p-4 flex items-center justify-between">
                        <span class="text-white font-medium">${r.filename}</span>
                        <span class="${r.status === 'success' ? 'text-green-400' : 'text-red-400'} flex items-center gap-2">
                            <i class="fas ${r.status === 'success' ? 'fa-check-circle' : 'fa-exclamation-circle'}"></i>
                            ${r.status === 'success' ? r.records + ' registros' : (r.message || 'Error')}
                        </span>
                    </div>
                `).join('');

                loadStats();
                showNotification(`‚úÖ ${data.results.filter(r => r.status === 'success').length} archivos procesados exitosamente`, 'success');

            } catch (error) {
                console.error('Error:', error);
                progressBar.classList.remove('from-blue-500', 'to-purple-600');
                progressBar.classList.add('from-red-500', 'to-pink-600');
                progressTitle.textContent = '‚ùå Error en el procesamiento';
                progressPercent.textContent = 'Error';
                addLog(`Error: ${error.message}`, 'error');
                showNotification('Error al procesar archivos', 'error');
            }
        }

        // Notification system
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `fixed top-4 right-4 glass-morphism px-6 py-4 rounded-xl text-white font-medium z-50 flex items-center gap-3 ${
                type === 'success' ? 'bg-green-500/20' : 
                type === 'error' ? 'bg-red-500/20' : 'bg-blue-500/20'
            }`;
            
            const icon = type === 'success' ? 'fa-check-circle' : 
                         type === 'error' ? 'fa-exclamation-circle' : 'fa-info-circle';
            
            notification.innerHTML = `
                <i class="fas ${icon} ${
                    type === 'success' ? 'text-green-400' : 
                    type === 'error' ? 'text-red-400' : 'text-blue-400'
                }"></i>
                <span>${message}</span>
            `;
            
            document.body.appendChild(notification);
            
            // Animate in
            setTimeout(() => {
                notification.style.transform = 'translateX(0)';
                notification.style.opacity = '1';
            }, 100);
            
            // Remove after 3 seconds
            setTimeout(() => {
                notification.style.transform = 'translateX(400px)';
                notification.style.opacity = '0';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }

        // Load stats
        async function loadStats() {
            try {
                const response = await fetch('/api/stats');
                const stats = await response.json();
                
                document.getElementById('statEmployees').textContent = stats.total_employees;
                document.getElementById('statRecords').textContent = stats.total_payroll_records;
                document.getElementById('statPeriods').textContent = stats.total_periods;
                document.getElementById('statNetPay').textContent = '¬•' + (stats.total_net_pay || 0).toLocaleString();
                document.getElementById('recordCount').textContent = stats.total_payroll_records + ' registros';
            } catch (error) {
                console.error('Error loading stats:', error);
            }
        }

        // Load data
        async function loadData() {
            try {
                const response = await fetch('/api/data');
                const data = await response.json();
                
                const tbody = document.getElementById('dataTable');
                tbody.innerHTML = data.records.map(r => `
                    <tr class="hover:bg-white/5 transition-colors duration-200">
                        <td class="px-6 py-4 text-white">${r.employee_id}</td>
                        <td class="px-6 py-4 text-white">${r.name_jp || r.name_roman || '-'}</td>
                        <td class="px-6 py-4 text-white">${r.period || '-'}</td>
                        <td class="px-6 py-4 text-right text-white font-medium">¬•${(r.total_pay || 0).toLocaleString()}</td>
                        <td class="px-6 py-4 text-right text-white">¬•${(r.deduction_total || 0).toLocaleString()}</td>
                        <td class="px-6 py-4 text-right text-white font-bold">¬•${(r.net_pay || 0).toLocaleString()}</td>
                    </tr>
                `).join('');
            } catch (error) {
                console.error('Error loading data:', error);
                showNotification('Error al cargar datos', 'error');
            }
        }

        // Export functions
        function exportAll() { 
            showNotification('üì• Descargando ALL...', 'info');
            window.location.href = '/api/export/all'; 
        }
        function exportMonthly() { 
            showNotification('üì• Descargando mensual...', 'info');
            window.location.href = '/api/export/monthly'; 
        }
        function exportChingin() { 
            showNotification('üì• Descargando Ë≥ÉÈáëÂè∞Â∏≥...', 'info');
            window.location.href = '/api/export/chingin'; 
        }

        // Employee search
        async function searchEmployee() {
            const employeeId = document.getElementById('employeeIdInput').value.trim();
            if (!employeeId) {
                showNotification('Por favor ingresa el ID del empleado', 'error');
                return;
            }

            try {
                const response = await fetch(`/api/employee/${employeeId}`);
                const data = await response.json();

                if (data.found) {
                    document.getElementById('empName').textContent = data.name_roman || data.name_jp || '-';
                    document.getElementById('empId').textContent = `ID: ${data.employee_id}`;
                    document.getElementById('empDispatch').textContent = data.dispatch || '-';
                    document.getElementById('empRecords').textContent = data.records || 0;
                    document.getElementById('empPeriods').textContent = data.periods ? data.periods.slice(0, 3).join(', ') : '-';
                    document.getElementById('empKana').textContent = data.name_jp || '-';
                    document.getElementById('empRoman').textContent = data.name_roman || '-';

                    document.getElementById('employeeResult').classList.remove('hidden');
                    document.getElementById('employeeNotFound').classList.add('hidden');
                    
                    showNotification('‚úÖ Empleado encontrado', 'success');
                } else {
                    document.getElementById('employeeNotFound').classList.remove('hidden');
                    document.getElementById('employeeResult').classList.add('hidden');
                    showNotification('Empleado no encontrado', 'error');
                }
            } catch (error) {
                console.error('Error:', error);
                showNotification('Error al buscar empleado', 'error');
            }
        }

        function generateChingin() {
            const employeeId = document.getElementById('employeeIdInput').value.trim();
            if (!employeeId) {
                showNotification('Por favor busca un empleado primero', 'error');
                return;
            }
            const year = document.getElementById('yearSelect').value;
            showNotification('üì• Generando Ë≥ÉÈáëÂè∞Â∏≥...', 'info');
            window.location.href = `/api/employee/${employeeId}/chingin?year=${year}`;
        }

        function previewChingin() {
            const employeeId = document.getElementById('employeeIdInput').value.trim();
            if (!employeeId) {
                showNotification('Por favor busca un empleado primero', 'error');
                return;
            }
            showNotification('üëÅÔ∏è Cargando vista previa...', 'info');
            // Implementation for preview would go here
        }

        function clearAllData() {
            if (confirm('‚ö†Ô∏è ¬øEst√°s seguro de que quieres borrar TODOS los datos?')) {
                showNotification('üóëÔ∏è Borrando todos los datos...', 'info');
                // Implementation would go here
            }
        }

        function createBackup() {
            showNotification('üíæ Creando backup...', 'info');
            // Implementation would go here
        }

        function loadAudit() {
            showNotification('üìã Cargando auditor√≠a...', 'info');
            // Implementation would go here
        }

        function loadSettings() {
            showNotification('‚öôÔ∏è Cargando configuraci√≥n...', 'info');
            // Implementation would go here
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            loadStats();
            showNotification('üöÄ Ë≥ÉÈáëÂè∞Â∏≥ Generator v4.1 PRO listo', 'success');
        });
    </script>
    
    <!-- Theme Selector -->
    <div id="themeSelector" class="fixed bottom-6 right-6 z-50 glass-morphism rounded-2xl p-4 border border-white/20">
        <div class="flex items-center gap-3 mb-3">
            <i class="fas fa-palette text-white text-lg"></i>
            <span class="text-white font-medium">Tema de Interfaz</span>
        </div>
        <div class="flex gap-2">
            <button onclick="setTheme('moderno')" id="btnModerno" class="theme-btn active px-4 py-2 rounded-xl text-sm font-medium transition-all duration-300 flex items-center gap-2">
                <i class="fas fa-rocket"></i>
                Moderno
            </button>
            <button onclick="setTheme('clasico')" id="btnClasico" class="theme-btn px-4 py-2 rounded-xl text-sm font-medium transition-all duration-300 flex items-center gap-2">
                <i class="fas fa-desktop"></i>
                Cl√°sico
            </button>
        </div>
        <div class="mt-3 text-white/80 text-xs">
            <i class="fas fa-info-circle"></i>
            Ctrl+Shift+T para mostrar/ocultar
        </div>
    </div>

    <style>
    .theme-btn {
        background: rgba(255, 255, 255, 0.1);
        color: rgba(255, 255, 255, 0.7);
        border: 1px solid rgba(255, 255, 255, 0.2);
    }

    .theme-btn:hover {
        background: rgba(255, 255, 255, 0.2);
        color: rgba(255, 255, 255, 0.9);
        transform: translateY(-1px);
    }

    .theme-btn.active {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border-color: transparent;
    }

    #themeSelector {
        transform: translateY(100px);
        opacity: 0;
        transition: all 0.3s ease;
    }

    #themeSelector.show {
        transform: translateY(0);
        opacity: 1;
    }
    </style>

    <script>
    function setTheme(theme) {
        // Actualizar botones
        document.querySelectorAll('.theme-btn').forEach(btn => btn.classList.remove('active'));
        
        if (theme === 'moderno') {
            document.getElementById('btnModerno').classList.add('active');
            localStorage.setItem('chingin-theme', 'moderno');
        } else {
            document.getElementById('btnClasico').classList.add('active');
            localStorage.setItem('chingin-theme', 'clasico');
        }
        
        // Redirigir al tema seleccionado
        window.location.href = `/theme/${theme}`;
    }

    // Toggle selector con Ctrl+Shift+T
    let selectorVisible = false;
    document.addEventListener('keydown', (e) => {
        if (e.ctrlKey && e.shiftKey && e.key === 'T') {
            e.preventDefault();
            selectorVisible = !selectorVisible;
            const selector = document.getElementById('themeSelector');
            if (selectorVisible) {
                selector.classList.add('show');
            } else {
                selector.classList.remove('show');
            }
        }
    });

    // Mostrar selector temporalmente al cargar
    document.addEventListener('DOMContentLoaded', () => {
        const savedTheme = localStorage.getItem('chingin-theme') || 'moderno';
        
        // Actualizar bot√≥n activo seg√∫n tema guardado
        if (savedTheme === 'moderno') {
            document.getElementById('btnModerno').classList.add('active');
        } else {
            document.getElementById('btnClasico').classList.add('active');
        }
        
        // Mostrar selector brevemente
        setTimeout(() => {
            document.getElementById('themeSelector').classList.add('show');
            setTimeout(() => {
                document.getElementById('themeSelector').classList.remove('show');
            }, 4000);
        }, 1500);
    });
    </script>
</body>
</html>
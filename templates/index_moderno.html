<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ë≥ÉÈáëÂè∞Â∏≥ Generator v4.1 PRO - Modern UI</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <!-- Lordicon - Iconos Animados -->
    <script src="https://cdn.lordicon.com/lordicon.js"></script>
    <!-- AOS - Animate On Scroll -->
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');
        
        * {
            font-family: 'Inter', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #2563eb 0%, #1e40af 100%);
            min-height: 100vh;
        }
        
        .glass-morphism {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .gradient-text {
            background: linear-gradient(135deg, #2563eb 0%, #1e40af 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .hover-scale {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .hover-scale:hover {
            transform: translateY(-2px) scale(1.02);
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        
        .tab-active {
            background: linear-gradient(135deg, #2563eb 0%, #1e40af 100%);
            color: white;
        }
        
        .progress-glow {
            box-shadow: 0 0 20px rgba(37, 99, 235, 0.5);
        }
        
        .terminal {
            background: #1a1a2e;
            color: #0f0;
            font-family: 'Fira Code', 'Consolas', monospace;
        }
        
        .floating {
            animation: float 3s ease-in-out infinite;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        
        .pulse {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }
        
        .gradient-border {
            background: linear-gradient(135deg, #2563eb, #1e40af, #3b82f6, #60a5fa);
            background-size: 400% 400%;
            animation: gradient 15s ease infinite;
        }
        
        @keyframes gradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        .stat-card {
            background: linear-gradient(135deg, rgba(255,255,255,0.9), rgba(255,255,255,0.7));
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255,255,255,0.3);
        }
        
        .neon-text {
            text-shadow: 0 0 10px rgba(37, 99, 235, 0.8),
                         0 0 20px rgba(37, 99, 235, 0.6),
                         0 0 30px rgba(37, 99, 235, 0.4);
        }

        /* Fix para select/option - texto visible en dropdown */
        select option {
            background-color: #1a1a2e;
            color: #ffffff;
            padding: 10px;
        }

        select option:hover,
        select option:focus,
        select option:checked {
            background-color: #2563eb;
            color: #ffffff;
        }

        /* Mejorar contraste de glassmorphism */
        .glass-morphism {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.25);
        }

        /* Stat cards con mejor contraste - texto oscuro sobre fondo claro */
        .stat-card {
            background: linear-gradient(135deg, rgba(255,255,255,0.95), rgba(255,255,255,0.9));
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255,255,255,0.5);
        }

        .stat-card p.text-sm {
            color: #4a5568 !important;
        }

        .stat-card .text-3xl {
            color: #1a202c !important;
        }

        /* Mejorar visibilidad de textos con baja opacidad */
        .glass-morphism p[class*="text-white/70"],
        .glass-morphism p[class*="text-white/80"],
        section p[class*="text-white/70"] {
            color: rgba(255, 255, 255, 0.95) !important;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
        }

        /* Inputs con mejor legibilidad */
        input[type="text"],
        select {
            background-color: rgba(255, 255, 255, 0.15) !important;
        }

        /* ========== NUEVOS EFECTOS VISUALES ========== */

        /* Efecto 3D Tilt en tarjetas */
        .card-3d {
            transform-style: preserve-3d;
            transition: transform 0.5s cubic-bezier(0.23, 1, 0.32, 1);
        }

        .card-3d:hover {
            transform: perspective(1000px) rotateX(5deg) rotateY(-5deg) scale(1.02);
        }

        .card-3d-inner {
            transform: translateZ(30px);
        }

        /* Efecto de brillo al hover */
        .shine-effect {
            position: relative;
            overflow: hidden;
        }

        .shine-effect::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(
                45deg,
                transparent 30%,
                rgba(255, 255, 255, 0.3) 50%,
                transparent 70%
            );
            transform: translateX(-100%) rotate(45deg);
            transition: transform 0.6s ease;
        }

        .shine-effect:hover::before {
            transform: translateX(100%) rotate(45deg);
        }

        /* Botones con efecto ripple */
        .btn-ripple {
            position: relative;
            overflow: hidden;
        }

        .btn-ripple::after {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            background: radial-gradient(circle, rgba(255,255,255,0.3) 0%, transparent 60%);
            transform: scale(0);
            opacity: 0;
            transition: transform 0.5s, opacity 0.3s;
        }

        .btn-ripple:active::after {
            transform: scale(2);
            opacity: 1;
            transition: 0s;
        }

        /* Iconos con bounce */
        .icon-bounce:hover {
            animation: iconBounce 0.6s ease;
        }

        @keyframes iconBounce {
            0%, 100% { transform: translateY(0); }
            25% { transform: translateY(-8px); }
            50% { transform: translateY(0); }
            75% { transform: translateY(-4px); }
        }

        /* Efecto glow pulsante */
        .glow-pulse {
            animation: glowPulse 2s ease-in-out infinite;
        }

        @keyframes glowPulse {
            0%, 100% {
                box-shadow: 0 0 5px rgba(37, 99, 235, 0.5),
                            0 0 20px rgba(37, 99, 235, 0.3);
            }
            50% {
                box-shadow: 0 0 20px rgba(37, 99, 235, 0.8),
                            0 0 40px rgba(37, 99, 235, 0.5);
            }
        }

        /* Texto con gradiente animado */
        .animated-gradient-text {
            background: linear-gradient(90deg, #2563eb, #1e40af, #3b82f6, #2563eb);
            background-size: 300% 100%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: gradientText 4s ease infinite;
        }

        @keyframes gradientText {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* Ondas de fondo animadas */
        .wave-bg {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 200px;
            pointer-events: none;
            z-index: 0;
        }

        .wave {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 200%;
            height: 100%;
            background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1440 320'%3E%3Cpath fill='rgba(255,255,255,0.05)' d='M0,192L48,176C96,160,192,128,288,133.3C384,139,480,181,576,181.3C672,181,768,139,864,128C960,117,1056,139,1152,154.7C1248,171,1344,181,1392,186.7L1440,192L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z'%3E%3C/path%3E%3C/svg%3E") repeat-x;
            animation: wave 15s linear infinite;
        }

        .wave:nth-child(2) {
            bottom: 10px;
            opacity: 0.5;
            animation: wave 12s linear reverse infinite;
        }

        .wave:nth-child(3) {
            bottom: 20px;
            opacity: 0.3;
            animation: wave 20s linear infinite;
        }

        @keyframes wave {
            0% { transform: translateX(0); }
            100% { transform: translateX(-50%); }
        }

        /* Part√≠culas flotantes */
        .particle {
            position: fixed;
            pointer-events: none;
            opacity: 0.6;
            animation: particleFloat 20s infinite;
        }

        @keyframes particleFloat {
            0%, 100% {
                transform: translateY(100vh) rotate(0deg);
                opacity: 0;
            }
            10% { opacity: 0.6; }
            90% { opacity: 0.6; }
            100% {
                transform: translateY(-100vh) rotate(720deg);
                opacity: 0;
            }
        }

        /* Badge animado */
        .badge-new {
            position: relative;
            background: linear-gradient(135deg, #3b82f6, #60a5fa);
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 10px;
            font-weight: bold;
            color: white;
            animation: badgePop 0.5s ease;
        }

        @keyframes badgePop {
            0% { transform: scale(0); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }

        /* Loader moderno */
        .loader-modern {
            width: 40px;
            height: 40px;
            border: 3px solid rgba(255,255,255,0.3);
            border-top-color: #2563eb;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Skeleton loading */
        .skeleton {
            background: linear-gradient(90deg, rgba(255,255,255,0.1) 25%, rgba(255,255,255,0.2) 50%, rgba(255,255,255,0.1) 75%);
            background-size: 200% 100%;
            animation: skeleton 1.5s infinite;
        }

        @keyframes skeleton {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }

        /* Tooltip moderno */
        .tooltip-modern {
            position: relative;
        }

        .tooltip-modern::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%) translateY(10px);
            padding: 8px 12px;
            background: rgba(0,0,0,0.8);
            color: white;
            font-size: 12px;
            border-radius: 8px;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .tooltip-modern:hover::after {
            opacity: 1;
            visibility: visible;
            transform: translateX(-50%) translateY(-5px);
        }

        /* Confetti explosion (para √©xito) */
        .confetti {
            position: fixed;
            pointer-events: none;
            z-index: 1000;
        }
    </style>
</head>
<body class="min-h-screen">
    <!-- Animated Background -->
    <div class="fixed inset-0 overflow-hidden pointer-events-none">
        <div class="absolute w-96 h-96 bg-blue-600 rounded-full opacity-10 blur-3xl -top-48 -left-48 floating"></div>
        <div class="absolute w-96 h-96 bg-blue-500 rounded-full opacity-10 blur-3xl -bottom-48 -right-48 floating" style="animation-delay: 1s;"></div>
        <div class="absolute w-64 h-64 bg-blue-400 rounded-full opacity-10 blur-2xl top-1/2 left-1/2 floating" style="animation-delay: 2s;"></div>
    </div>

    <!-- Ondas animadas de fondo -->
    <div class="wave-bg">
        <div class="wave"></div>
        <div class="wave"></div>
        <div class="wave"></div>
    </div>

    <!-- Part√≠culas flotantes -->
    <div id="particles"></div>

    <!-- Header -->
    <header class="glass-morphism sticky top-0 z-50 border-b border-white/20">
        <div class="max-w-7xl mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center gap-4">
                    <div class="w-12 h-12 gradient-border rounded-xl flex items-center justify-center">
                        <i class="fas fa-chart-line text-white text-xl"></i>
                    </div>
                    <div>
                        <h1 class="text-2xl font-bold text-white">Ë≥ÉÈáëÂè∞Â∏≥ Generator</h1>
                        <p class="text-white/80 text-sm">v4.1 PRO - Modern UI</p>
                    </div>
                </div>
                <div class="flex items-center gap-4">
                    <div class="glass-morphism px-4 py-2 rounded-full">
                        <span class="text-white text-sm flex items-center gap-2">
                            <i class="fas fa-database text-green-400"></i>
                            BD Conectada
                        </span>
                    </div>
                    <div class="glass-morphism px-4 py-2 rounded-full">
                        <span id="recordCount" class="text-white text-sm">0 registros</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-6 py-8">
        <!-- Stats Dashboard -->
        <section class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
            <!-- Tarjeta Empleados -->
            <div class="stat-card card-3d shine-effect rounded-2xl p-6" data-aos="fade-up" data-aos-delay="0">
                <div class="card-3d-inner">
                    <div class="flex items-center justify-between mb-4">
                        <div class="w-14 h-14 bg-blue-500/20 rounded-xl flex items-center justify-center glow-pulse">
                            <lord-icon src="https://cdn.lordicon.com/dxjqoygy.json" trigger="hover" colors="primary:#3b82f6" style="width:36px;height:36px"></lord-icon>
                        </div>
                        <span class="badge-new">+12%</span>
                    </div>
                    <p class="text-gray-500 text-sm mb-1 font-medium">Empleados</p>
                    <p id="statEmployees" class="text-3xl font-bold text-gray-800">0</p>
                    <div class="mt-3 h-2 bg-blue-500/20 rounded-full overflow-hidden">
                        <div class="h-full bg-gradient-to-r from-blue-400 to-blue-600 rounded-full transition-all duration-1000" style="width: 75%;"></div>
                    </div>
                </div>
            </div>

            <!-- Tarjeta Registros -->
            <div class="stat-card card-3d shine-effect rounded-2xl p-6" data-aos="fade-up" data-aos-delay="100">
                <div class="card-3d-inner">
                    <div class="flex items-center justify-between mb-4">
                        <div class="w-14 h-14 bg-green-500/20 rounded-xl flex items-center justify-center glow-pulse" style="--glow-color: rgba(34, 197, 94, 0.5);">
                            <lord-icon src="https://cdn.lordicon.com/nocovwne.json" trigger="hover" colors="primary:#22c55e" style="width:36px;height:36px"></lord-icon>
                        </div>
                        <span class="badge-new" style="background: linear-gradient(135deg, #22c55e, #16a34a);">+8%</span>
                    </div>
                    <p class="text-gray-500 text-sm mb-1 font-medium">Registros</p>
                    <p id="statRecords" class="text-3xl font-bold text-gray-800">0</p>
                    <div class="mt-3 h-2 bg-green-500/20 rounded-full overflow-hidden">
                        <div class="h-full bg-gradient-to-r from-green-400 to-green-600 rounded-full transition-all duration-1000" style="width: 82%;"></div>
                    </div>
                </div>
            </div>

            <!-- Tarjeta Periodos -->
            <div class="stat-card card-3d shine-effect rounded-2xl p-6" data-aos="fade-up" data-aos-delay="200">
                <div class="card-3d-inner">
                    <div class="flex items-center justify-between mb-4">
                        <div class="w-14 h-14 bg-blue-500/20 rounded-xl flex items-center justify-center glow-pulse" style="--glow-color: rgba(37, 99, 235, 0.5);">
                            <lord-icon src="https://cdn.lordicon.com/abfverha.json" trigger="hover" colors="primary:#3b82f6" style="width:36px;height:36px"></lord-icon>
                        </div>
                        <span class="badge-new" style="background: linear-gradient(135deg, #3b82f6, #2563eb);">+15%</span>
                    </div>
                    <p class="text-gray-500 text-sm mb-1 font-medium">Periodos</p>
                    <p id="statPeriods" class="text-3xl font-bold text-gray-800">0</p>
                    <div class="mt-3 h-2 bg-blue-500/20 rounded-full overflow-hidden">
                        <div class="h-full bg-gradient-to-r from-blue-400 to-blue-600 rounded-full transition-all duration-1000" style="width: 68%;"></div>
                    </div>
                </div>
            </div>

            <!-- Tarjeta Total Neto -->
            <div class="stat-card card-3d shine-effect rounded-2xl p-6" data-aos="fade-up" data-aos-delay="300">
                <div class="card-3d-inner">
                    <div class="flex items-center justify-between mb-4">
                        <div class="w-14 h-14 bg-orange-500/20 rounded-xl flex items-center justify-center glow-pulse" style="--glow-color: rgba(249, 115, 22, 0.5);">
                            <lord-icon src="https://cdn.lordicon.com/qhviklyi.json" trigger="hover" colors="primary:#f97316" style="width:36px;height:36px"></lord-icon>
                        </div>
                        <span class="badge-new" style="background: linear-gradient(135deg, #f97316, #ea580c);">+5%</span>
                    </div>
                    <p class="text-gray-500 text-sm mb-1 font-medium">Total Neto</p>
                    <p id="statNetPay" class="text-3xl font-bold text-gray-800">¬•0</p>
                    <div class="mt-3 h-2 bg-orange-500/20 rounded-full overflow-hidden">
                        <div class="h-full bg-gradient-to-r from-orange-400 to-orange-600 rounded-full transition-all duration-1000" style="width: 91%;"></div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Navigation Tabs -->
        <nav class="glass-morphism rounded-2xl p-2 mb-8">
            <div class="flex flex-wrap gap-2">
                <button onclick="showTab('upload')" id="tab-upload" class="tab-active px-6 py-3 rounded-xl font-medium text-white transition-all duration-300 flex items-center gap-2">
                    <i class="fas fa-cloud-upload-alt"></i>
                    Subir Archivos
                </button>
                <button onclick="showTab('data')" id="tab-data" class="px-6 py-3 rounded-xl font-medium text-white/80 hover:text-white hover:bg-white/10 transition-all duration-300 flex items-center gap-2">
                    <i class="fas fa-database"></i>
                    Datos
                </button>
                <button onclick="showTab('export')" id="tab-export" class="px-6 py-3 rounded-xl font-medium text-white/80 hover:text-white hover:bg-white/10 transition-all duration-300 flex items-center gap-2">
                    <i class="fas fa-download"></i>
                    Exportar
                </button>
                <button onclick="showTab('chingin')" id="tab-chingin" class="px-6 py-3 rounded-xl font-medium text-white/80 hover:text-white hover:bg-white/10 transition-all duration-300 flex items-center gap-2">
                    <i class="fas fa-file-invoice"></i>
                    Ë≥ÉÈáëÂè∞Â∏≥
                </button>
                <button onclick="showTab('backup')" id="tab-backup" class="px-6 py-3 rounded-xl font-medium text-white/80 hover:text-white hover:bg-white/10 transition-all duration-300 flex items-center gap-2">
                    <i class="fas fa-shield-alt"></i>
                    Backup
                </button>
                <button onclick="showTab('audit')" id="tab-audit" class="px-6 py-3 rounded-xl font-medium text-white/80 hover:text-white hover:bg-white/10 transition-all duration-300 flex items-center gap-2">
                    <i class="fas fa-history"></i>
                    Auditor√≠a
                </button>
                <button onclick="showTab('settings')" id="tab-settings" class="px-6 py-3 rounded-xl font-medium text-white/80 hover:text-white hover:bg-white/10 transition-all duration-300 flex items-center gap-2">
                    <i class="fas fa-cog"></i>
                    Config
                </button>
            </div>
        </nav>

        <!-- Tab: Upload -->
        <section id="section-upload" class="tab-content">
            <div class="glass-morphism rounded-2xl p-8 mb-6">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-white flex items-center gap-3">
                        <i class="fas fa-cloud-upload-alt text-blue-400"></i>
                        Subir Archivos Âã§ÊÄ†Ë°®
                    </h2>
                    <button onclick="clearAllData()" class="bg-red-500/20 hover:bg-red-500/30 text-red-400 hover:text-red-300 px-6 py-3 rounded-xl font-medium transition-all duration-300 flex items-center gap-2">
                        <i class="fas fa-trash-alt"></i>
                        Borrar Todos los Datos
                    </button>
                </div>
                
                <div id="dropZone" class="border-3 border-dashed border-white/30 rounded-2xl p-12 text-center cursor-pointer hover:border-white/50 hover:bg-white/5 transition-all duration-300 glow-pulse" data-aos="zoom-in">
                    <div class="flex flex-col items-center gap-4">
                        <div class="w-24 h-24 bg-gradient-to-br from-blue-500 to-blue-700 rounded-2xl flex items-center justify-center floating shadow-2xl">
                            <lord-icon src="https://cdn.lordicon.com/smwmetfi.json" trigger="loop" delay="2000" colors="primary:#ffffff,secondary:#ffffff" style="width:56px;height:56px"></lord-icon>
                        </div>
                        <p class="text-white text-xl font-bold animated-gradient-text">„Éï„Ç°„Ç§„É´„Çí„Éâ„É©„ÉÉ„Ç∞ÔºÜ„Éâ„É≠„ÉÉ„Éó</p>
                        <p class="text-white/90 text-lg">o haz clic para seleccionar</p>
                        <div class="flex items-center gap-3 mt-2">
                            <span class="px-3 py-1 bg-white/10 rounded-full text-white/80 text-sm">.xlsm</span>
                            <span class="px-3 py-1 bg-white/10 rounded-full text-white/80 text-sm">.xlsx</span>
                            <span class="px-3 py-1 bg-white/10 rounded-full text-white/80 text-sm">.xls</span>
                        </div>
                    </div>
                    <input type="file" id="fileInput" multiple accept=".xlsm,.xlsx,.xls" class="hidden">
                </div>

                <!-- Progress Section -->
                <div id="progressSection" class="hidden">
                    <div class="glass-morphism rounded-2xl p-6">
                        <div class="flex justify-between items-center mb-4">
                            <span class="text-white font-medium text-lg" id="progressTitle">Procesando...</span>
                            <span class="text-white/80 text-lg" id="progressPercent">0%</span>
                        </div>
                        <div class="w-full bg-white/20 rounded-full h-6 overflow-hidden">
                            <div id="progressBar" class="bg-gradient-to-r from-blue-500 to-blue-700 h-6 rounded-full transition-all duration-500 progress-glow" style="width: 0%"></div>
                        </div>
                        <div class="mt-4 text-white/70 text-sm" id="progressDetails">
                            <!-- Progress details -->
                        </div>
                        <div id="progressLog" class="mt-4 max-h-64 overflow-y-auto terminal rounded-xl p-4 border border-white/20 hidden">
                            <div class="text-green-400 mb-2">$ chingin-processor --upload --modern-ui</div>
                            <!-- Terminal log -->
                        </div>
                    </div>
                </div>

                <div id="fileList" class="mt-6 space-y-3 hidden">
                    <h3 class="text-white text-lg font-medium mb-3 flex items-center gap-2">
                        <i class="fas fa-check-circle text-green-400"></i>
                        Archivos procesados:
                    </h3>
                    <div id="fileItems" class="space-y-2"></div>
                </div>
            </div>
        </section>

        <!-- Tab: Data -->
        <section id="section-data" class="tab-content hidden">
            <div class="glass-morphism rounded-2xl p-8">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-white flex items-center gap-3">
                        <i class="fas fa-database text-green-400"></i>
                        Datos de N√≥mina
                    </h2>
                    <div class="flex gap-3">
                        <button onclick="clearAllData()" class="bg-red-500/20 hover:bg-red-500/30 text-red-400 hover:text-red-300 px-6 py-3 rounded-xl font-medium transition-all duration-300 flex items-center gap-2">
                            <i class="fas fa-trash-alt"></i>
                            Borrar Todo
                        </button>
                        <button onclick="loadData()" class="bg-blue-500/20 hover:bg-blue-500/30 text-blue-400 hover:text-blue-300 px-6 py-3 rounded-xl font-medium transition-all duration-300 flex items-center gap-2">
                            <i class="fas fa-sync-alt"></i>
                            Actualizar
                        </button>
                    </div>
                </div>
                <div class="overflow-x-auto">
                    <div class="glass-morphism rounded-xl overflow-hidden">
                        <table class="w-full">
                            <thead class="bg-white/10">
                                <tr>
                                    <th class="px-6 py-4 text-left text-white font-medium">ÂæìÊ•≠Âì°Áï™Âè∑</th>
                                    <th class="px-6 py-4 text-left text-white font-medium">Ê∞èÂêç</th>
                                    <th class="px-6 py-4 text-left text-white font-medium">ÊîØÁµ¶ÂàÜ</th>
                                    <th class="px-6 py-4 text-right text-white font-medium">Á∑èÊîØÁµ¶È°ç</th>
                                    <th class="px-6 py-4 text-right text-white font-medium">ÊéßÈô§ÂêàË®à</th>
                                    <th class="px-6 py-4 text-right text-white font-medium">Â∑ÆÂºïÊîØÁµ¶È°ç</th>
                                </tr>
                            </thead>
                            <tbody id="dataTable" class="divide-y divide-white/10"></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>

        <!-- Tab: Export -->
        <section id="section-export" class="tab-content hidden">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <!-- ALLÂá∫Âäõ Card -->
                <div class="glass-morphism card-3d shine-effect rounded-2xl p-8 text-center" data-aos="fade-up" data-aos-delay="0">
                    <div class="card-3d-inner">
                        <div class="w-20 h-20 bg-gradient-to-br from-green-400 to-emerald-600 rounded-2xl flex items-center justify-center mx-auto mb-6 shadow-lg glow-pulse" style="--glow-color: rgba(34, 197, 94, 0.4);">
                            <lord-icon src="https://cdn.lordicon.com/yqzmiobz.json" trigger="hover" colors="primary:#ffffff,secondary:#ffffff" style="width:48px;height:48px"></lord-icon>
                        </div>
                        <h3 class="text-xl font-bold text-white mb-2">ALLÂá∫Âäõ</h3>
                        <span class="badge-new mb-4 inline-block" style="background: linear-gradient(135deg, #22c55e, #16a34a);">Excel</span>
                        <p class="text-white/80 mb-6">Todos los datos consolidados en un archivo</p>
                        <button onclick="exportAll(); triggerConfetti();" class="btn-ripple w-full bg-gradient-to-r from-green-500 to-emerald-600 text-white py-4 rounded-xl font-semibold hover:shadow-xl hover:scale-105 transition-all duration-300 flex items-center justify-center gap-3">
                            <lord-icon src="https://cdn.lordicon.com/ternnbni.json" trigger="hover" colors="primary:#ffffff" style="width:24px;height:24px"></lord-icon>
                            Descargar Excel
                        </button>
                    </div>
                </div>

                <!-- ÊúàÂà•ÂàÜÂâ≤ Card -->
                <div class="glass-morphism card-3d shine-effect rounded-2xl p-8 text-center" data-aos="fade-up" data-aos-delay="100">
                    <div class="card-3d-inner">
                        <div class="w-20 h-20 bg-gradient-to-br from-blue-400 to-blue-700 rounded-2xl flex items-center justify-center mx-auto mb-6 shadow-lg glow-pulse" style="--glow-color: rgba(37, 99, 235, 0.4);">
                            <lord-icon src="https://cdn.lordicon.com/wmlleaaf.json" trigger="hover" colors="primary:#ffffff,secondary:#ffffff" style="width:48px;height:48px"></lord-icon>
                        </div>
                        <h3 class="text-xl font-bold text-white mb-2">ÊúàÂà•ÂàÜÂâ≤</h3>
                        <span class="badge-new mb-4 inline-block" style="background: linear-gradient(135deg, #3b82f6, #2563eb);">Mensual</span>
                        <p class="text-white/80 mb-6">Hojas separadas por cada mes</p>
                        <button onclick="exportMonthly(); triggerConfetti();" class="btn-ripple w-full bg-gradient-to-r from-blue-500 to-blue-700 text-white py-4 rounded-xl font-semibold hover:shadow-xl hover:scale-105 transition-all duration-300 flex items-center justify-center gap-3">
                            <lord-icon src="https://cdn.lordicon.com/ternnbni.json" trigger="hover" colors="primary:#ffffff" style="width:24px;height:24px"></lord-icon>
                            Descargar Excel
                        </button>
                    </div>
                </div>

                <!-- Ë≥ÉÈáëÂè∞Â∏≥ Card -->
                <div class="glass-morphism card-3d shine-effect rounded-2xl p-8 text-center" data-aos="fade-up" data-aos-delay="200">
                    <div class="card-3d-inner">
                        <div class="w-20 h-20 bg-gradient-to-br from-orange-400 to-red-600 rounded-2xl flex items-center justify-center mx-auto mb-6 shadow-lg glow-pulse" style="--glow-color: rgba(249, 115, 22, 0.4);">
                            <lord-icon src="https://cdn.lordicon.com/puvaffet.json" trigger="hover" colors="primary:#ffffff,secondary:#ffffff" style="width:48px;height:48px"></lord-icon>
                        </div>
                        <h3 class="text-xl font-bold text-white mb-2">Ë≥ÉÈáëÂè∞Â∏≥</h3>
                        <span class="badge-new mb-4 inline-block" style="background: linear-gradient(135deg, #f97316, #ef4444);">ZIP</span>
                        <p class="text-white/80 mb-6">Un archivo por cada empleado</p>
                        <button onclick="exportChingin(); triggerConfetti();" class="btn-ripple w-full bg-gradient-to-r from-orange-500 to-red-600 text-white py-4 rounded-xl font-semibold hover:shadow-xl hover:scale-105 transition-all duration-300 flex items-center justify-center gap-3">
                            <lord-icon src="https://cdn.lordicon.com/zyzoecaw.json" trigger="hover" colors="primary:#ffffff" style="width:24px;height:24px"></lord-icon>
                            Descargar ZIP
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Tab: Chingin -->
        <section id="section-chingin" class="tab-content hidden">
            <div class="glass-morphism rounded-2xl p-8 mb-6">
                <h2 class="text-2xl font-bold text-white mb-6 flex items-center gap-3">
                    <i class="fas fa-file-invoice text-orange-400"></i>
                    Ë≥ÉÈáëÂè∞Â∏≥ - Generar por Empleado
                </h2>
                
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                    <div class="glass-morphism rounded-xl p-6">
                        <label class="block text-white font-medium mb-3 flex items-center gap-2">
                            <i class="fas fa-search text-blue-400"></i>
                            ÂæìÊ•≠Âì°Áï™Âè∑ (ID)
                        </label>
                        <input type="text" id="employeeIdInput" placeholder="Ej: 504010" 
                               class="w-full bg-white/10 border border-white/20 rounded-xl px-4 py-3 text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-300"
                               onkeypress="if(event.key==='Enter') searchEmployee()">
                    </div>
                    
                    <div class="glass-morphism rounded-xl p-6">
                        <label class="block text-white font-medium mb-3 flex items-center gap-2">
                            <i class="fas fa-calendar text-blue-400"></i>
                            Âπ¥Â∫¶
                        </label>
                        <select id="yearSelect" class="w-full bg-white/10 border border-white/20 rounded-xl px-4 py-3 text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-300">
                            <option value="2025">2025</option>
                            <option value="2024">2024</option>
                            <option value="2023">2023</option>
                        </select>
                    </div>
                </div>
                
                <div class="flex gap-4">
                    <button onclick="searchEmployee()" class="flex-1 bg-gradient-to-r from-blue-500 to-blue-700 text-white py-4 rounded-xl font-semibold hover:shadow-lg transition-all duration-300 flex items-center justify-center gap-2">
                        <i class="fas fa-search"></i>
                        üîç Ê§úÁ¥¢ Buscar
                    </button>
                </div>
            </div>

            <!-- Employee Result -->
            <div id="employeeResult" class="hidden">
                <div class="glass-morphism rounded-2xl p-8 mb-6">
                    <div class="flex items-center justify-between mb-6">
                        <div>
                            <h3 class="text-2xl font-bold text-white" id="empName">-</h3>
                            <p class="text-white/70" id="empId">-</p>
                        </div>
                        <div class="text-right">
                            <p class="text-white/70 text-sm">Ê¥æÈÅ£ÂÖà</p>
                            <p class="text-white font-medium" id="empDispatch">-</p>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                        <div class="glass-morphism rounded-xl p-4">
                            <p class="text-white/70 text-sm mb-2">ÁôªÈå≤Êï∞</p>
                            <p class="text-2xl font-bold text-blue-400" id="empRecords">0</p>
                        </div>
                        <div class="glass-morphism rounded-xl p-4">
                            <p class="text-white/70 text-sm mb-2">ÂØæË±°ÊúüÈñì</p>
                            <p class="text-lg font-semibold text-green-400" id="empPeriods">-</p>
                        </div>
                        <div class="glass-morphism rounded-xl p-4">
                            <p class="text-white/70 text-sm mb-2">Ê∞èÂêç</p>
                            <p class="text-sm font-semibold text-blue-400" id="empKana">-</p>
                            <p class="text-sm font-semibold text-blue-300" id="empRoman">-</p>
                        </div>
                    </div>

                    <div class="flex gap-4">
                        <button onclick="generateChingin()" class="flex-1 bg-gradient-to-r from-green-500 to-emerald-600 text-white py-4 rounded-xl font-semibold hover:shadow-lg transition-all duration-300 flex items-center justify-center gap-2">
                            <i class="fas fa-download"></i>
                            üì• Ë≥ÉÈáëÂè∞Â∏≥„Çí„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ
                        </button>
                        <button onclick="previewChingin()" class="flex-1 bg-gradient-to-r from-blue-500 to-blue-700 text-white py-4 rounded-xl font-semibold hover:shadow-lg transition-all duration-300 flex items-center justify-center gap-2">
                            <i class="fas fa-eye"></i>
                            üëÅÔ∏è „Éó„É¨„Éì„É•„Éº Preview
                        </button>
                    </div>
                </div>
            </div>

            <!-- Not Found -->
            <div id="employeeNotFound" class="hidden">
                <div class="glass-morphism rounded-2xl p-12 text-center">
                    <div class="w-20 h-20 bg-red-500/20 rounded-2xl flex items-center justify-center mx-auto mb-6">
                        <i class="fas fa-user-slash text-red-400 text-3xl"></i>
                    </div>
                    <p class="text-red-400 font-medium text-xl mb-2">ÂæìÊ•≠Âì°„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì</p>
                    <p class="text-white/70">El empleado no fue encontrado en la base de datos</p>
                </div>
            </div>
        </section>

        <!-- Other tabs (Backup, Audit, Settings) - Simplified for modern UI -->
        <section id="section-backup" class="tab-content hidden">
            <div class="glass-morphism rounded-2xl p-8 text-center">
                <i class="fas fa-shield-alt text-6xl text-blue-400 mb-6"></i>
                <h2 class="text-2xl font-bold text-white mb-4">Backup System</h2>
                <p class="text-white/70 mb-6">Gesti√≥n de backups y restauraci√≥n</p>
                <button onclick="createBackup()" class="bg-gradient-to-r from-blue-500 to-blue-700 text-white py-4 px-8 rounded-xl font-semibold hover:shadow-lg transition-all duration-300">
                    <i class="fas fa-plus mr-2"></i>Crear Backup
                </button>
            </div>
        </section>

        <section id="section-audit" class="tab-content hidden">
            <div class="glass-morphism rounded-2xl p-8 text-center">
                <i class="fas fa-history text-6xl text-green-400 mb-6"></i>
                <h2 class="text-2xl font-bold text-white mb-4">Audit Log</h2>
                <p class="text-white/70 mb-6">Historial de auditor√≠a del sistema</p>
                <button onclick="loadAudit()" class="bg-gradient-to-r from-green-500 to-emerald-600 text-white py-4 px-8 rounded-xl font-semibold hover:shadow-lg transition-all duration-300">
                    <i class="fas fa-list mr-2"></i>Ver Auditor√≠a
                </button>
            </div>
        </section>

        <section id="section-settings" class="tab-content hidden">
            <div class="glass-morphism rounded-2xl p-8">
                <h2 class="text-2xl font-bold text-white mb-6 flex items-center gap-3">
                    <i class="fas fa-cog text-blue-400"></i>
                    Configuraci√≥n del Sistema
                </h2>

                <div id="settingsList" class="space-y-4">
                    <!-- Settings will be loaded here -->
                </div>

                <div class="mt-6 flex justify-end">
                    <button type="button" onclick="loadSettings()" class="bg-gradient-to-r from-blue-500 to-blue-700 text-white py-3 px-6 rounded-xl font-semibold hover:shadow-lg transition-all duration-300 flex items-center gap-2">
                        <i class="fas fa-sync-alt"></i>
                        Recargar Configuraci√≥n
                    </button>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="glass-morphism mt-12 border-t border-white/20">
        <div class="max-w-7xl mx-auto px-6 py-6">
            <div class="flex justify-between items-center">
                <p class="text-white/70 text-sm">¬© 2025 Ë≥ÉÈáëÂè∞Â∏≥ Generator v4.1 PRO</p>
                <div class="flex items-center gap-4">
                    <span class="text-white/70 text-sm flex items-center gap-2">
                        <i class="fas fa-bolt text-yellow-400"></i>
                        Optimized Performance
                    </span>
                    <span class="text-white/70 text-sm flex items-center gap-2">
                        <i class="fas fa-robot text-blue-400"></i>
                        AI Powered
                    </span>
                </div>
            </div>
        </div>
    </footer>

    <script>
        // Modern UI JavaScript
        const apiCache = {
            data: {},
            ttl: 60000,
            get(key) {
                const cached = this.data[key];
                if (cached && (Date.now() - cached.timestamp < this.ttl)) {
                    return cached.value;
                }
                return null;
            },
            set(key, value) {
                this.data[key] = {
                    value: value,
                    timestamp: Date.now()
                };
            },
            clear() {
                this.data = {};
            }
        };

        // Tab navigation
        function showTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(el => el.classList.add('hidden'));
            document.querySelectorAll('[id^="tab-"]').forEach(el => el.classList.remove('tab-active'));
            document.getElementById('section-' + tabName).classList.remove('hidden');
            document.getElementById('tab-' + tabName).classList.add('tab-active');
            
            if (tabName === 'data') loadData();
            if (tabName === 'audit') loadAudit();
            if (tabName === 'settings') loadSettings();
        }

        // File upload
        const dropZone = document.getElementById('dropZone');
        const fileInput = document.getElementById('fileInput');

        dropZone.addEventListener('click', () => fileInput.click());
        dropZone.addEventListener('dragover', (e) => { 
            e.preventDefault(); 
            dropZone.classList.add('border-white/70', 'bg-white/10'); 
        });
        dropZone.addEventListener('dragleave', () => { 
            dropZone.classList.remove('border-white/70', 'bg-white/10'); 
        });
        dropZone.addEventListener('drop', (e) => {
            e.preventDefault();
            dropZone.classList.remove('border-white/70', 'bg-white/10');
            handleFiles(e.dataTransfer.files);
        });
        fileInput.addEventListener('change', (e) => handleFiles(e.target.files));

        async function handleFiles(files) {
            if (!files || files.length === 0) {
                showNotification('Por favor selecciona al menos un archivo', 'error');
                return;
            }

            const totalFiles = files.length;
            const progressSection = document.getElementById('progressSection');
            const progressBar = document.getElementById('progressBar');
            const progressPercent = document.getElementById('progressPercent');
            const progressTitle = document.getElementById('progressTitle');
            const progressDetails = document.getElementById('progressDetails');
            const progressLog = document.getElementById('progressLog');

            // Reset progress
            progressBar.style.width = '0%';
            progressBar.classList.remove('bg-gradient-to-r', 'from-green-500', 'to-emerald-600');
            progressBar.classList.add('bg-gradient-to-r', 'from-blue-500', 'to-blue-700');
            progressPercent.textContent = '0%';
            progressTitle.textContent = 'üöÄ Iniciando procesamiento...';
            progressDetails.textContent = '';
            
            // Show progress
            progressSection.classList.remove('hidden');
            progressLog.classList.remove('hidden');
            progressLog.innerHTML = '';

            const formData = new FormData();
            for (let file of files) {
                formData.append('files', file);
            }

            // Enhanced terminal logging
            const addLog = (msg, type = 'info') => {
                const colors = { 
                    info: 'text-green-400', 
                    success: 'text-green-300', 
                    error: 'text-red-400', 
                    warning: 'text-yellow-400',
                    cmd: 'text-cyan-400'
                };
                const icons = {
                    info: '   ',
                    success: ' ‚úì ',
                    error: ' ‚úó ',
                    warning: ' ‚ö† ',
                    cmd: ' $ '
                };
                const time = new Date().toLocaleTimeString('ja-JP', {hour: '2-digit', minute: '2-digit', second: '2-digit'});
                const icon = icons[type] || '   ';
                progressLog.innerHTML += `<div class="${colors[type]}"><span class="text-gray-500">[${time}]</span>${icon}${msg}</div>`;
                progressLog.scrollTop = progressLog.scrollHeight;
            };

            // Simulated progress with modern UI
            addLog('chingin-processor v4.1.0 --modern-ui', 'cmd');
            addLog('Processing files with enhanced performance...', 'info');

            try {
                const response = await fetch('/api/upload', { method: 'POST', body: formData });
                const data = await response.json();

                if (!response.ok) {
                    throw new Error(`Error HTTP: ${response.status}`);
                }

                // Success animation
                progressBar.classList.remove('from-blue-500', 'to-blue-700');
                progressBar.classList.add('from-green-500', 'to-emerald-600');
                progressTitle.textContent = '‚úÖ Procesamiento completado exitosamente';
                progressPercent.textContent = '100%';

                addLog('All files processed successfully!', 'success');
                addLog('Database updated with performance optimizations', 'info');

                // Show results
                document.getElementById('fileList').classList.remove('hidden');
                const fileItems = document.getElementById('fileItems');
                fileItems.innerHTML = data.results.map(r => `
                    <div class="glass-morphism rounded-xl p-4 flex items-center justify-between">
                        <span class="text-white font-medium">${r.filename}</span>
                        <span class="${r.status === 'success' ? 'text-green-400' : 'text-red-400'} flex items-center gap-2">
                            <i class="fas ${r.status === 'success' ? 'fa-check-circle' : 'fa-exclamation-circle'}"></i>
                            ${r.status === 'success' ? r.records + ' registros' : (r.message || 'Error')}
                        </span>
                    </div>
                `).join('');

                loadStats();
                showNotification(`‚úÖ ${data.results.filter(r => r.status === 'success').length} archivos procesados exitosamente`, 'success');

            } catch (error) {
                console.error('Error:', error);
                progressBar.classList.remove('from-blue-500', 'to-blue-700');
                progressBar.classList.add('from-red-500', 'to-red-700');
                progressTitle.textContent = '‚ùå Error en el procesamiento';
                progressPercent.textContent = 'Error';
                addLog(`Error: ${error.message}`, 'error');
                showNotification('Error al procesar archivos', 'error');
            }
        }

        // Notification system
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `fixed top-4 right-4 glass-morphism px-6 py-4 rounded-xl text-white font-medium z-50 flex items-center gap-3 ${
                type === 'success' ? 'bg-green-500/20' : 
                type === 'error' ? 'bg-red-500/20' : 'bg-blue-500/20'
            }`;
            
            const icon = type === 'success' ? 'fa-check-circle' : 
                         type === 'error' ? 'fa-exclamation-circle' : 'fa-info-circle';
            
            notification.innerHTML = `
                <i class="fas ${icon} ${
                    type === 'success' ? 'text-green-400' : 
                    type === 'error' ? 'text-red-400' : 'text-blue-400'
                }"></i>
                <span>${message}</span>
            `;
            
            document.body.appendChild(notification);
            
            // Animate in
            setTimeout(() => {
                notification.style.transform = 'translateX(0)';
                notification.style.opacity = '1';
            }, 100);
            
            // Remove after 3 seconds
            setTimeout(() => {
                notification.style.transform = 'translateX(400px)';
                notification.style.opacity = '0';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }

        // Load stats
        async function loadStats() {
            try {
                const response = await fetch('/api/stats');
                const stats = await response.json();
                
                document.getElementById('statEmployees').textContent = stats.total_employees;
                document.getElementById('statRecords').textContent = stats.total_payroll_records;
                document.getElementById('statPeriods').textContent = stats.total_periods;
                document.getElementById('statNetPay').textContent = '¬•' + (stats.total_net_pay || 0).toLocaleString();
                document.getElementById('recordCount').textContent = stats.total_payroll_records + ' registros';
            } catch (error) {
                console.error('Error loading stats:', error);
            }
        }

        // Load data
        async function loadData() {
            try {
                const response = await fetch('/api/data');
                const data = await response.json();
                
                const tbody = document.getElementById('dataTable');
                tbody.innerHTML = data.records.map(r => `
                    <tr class="hover:bg-white/5 transition-colors duration-200">
                        <td class="px-6 py-4 text-white">${r.employee_id}</td>
                        <td class="px-6 py-4 text-white">${r.name_jp || r.name_roman || '-'}</td>
                        <td class="px-6 py-4 text-white">${r.period || '-'}</td>
                        <td class="px-6 py-4 text-right text-white font-medium">¬•${(r.total_pay || 0).toLocaleString()}</td>
                        <td class="px-6 py-4 text-right text-white">¬•${(r.deduction_total || 0).toLocaleString()}</td>
                        <td class="px-6 py-4 text-right text-white font-bold">¬•${(r.net_pay || 0).toLocaleString()}</td>
                    </tr>
                `).join('');
            } catch (error) {
                console.error('Error loading data:', error);
                showNotification('Error al cargar datos', 'error');
            }
        }

        // Export functions
        function exportAll() { 
            showNotification('üì• Descargando ALL...', 'info');
            window.location.href = '/api/export/all'; 
        }
        function exportMonthly() { 
            showNotification('üì• Descargando mensual...', 'info');
            window.location.href = '/api/export/monthly'; 
        }
        function exportChingin() { 
            showNotification('üì• Descargando Ë≥ÉÈáëÂè∞Â∏≥...', 'info');
            window.location.href = '/api/export/chingin'; 
        }

        // Employee search
        async function searchEmployee() {
            const employeeId = document.getElementById('employeeIdInput').value.trim();
            if (!employeeId) {
                showNotification('Por favor ingresa el ID del empleado', 'error');
                return;
            }

            try {
                const response = await fetch(`/api/employee/${employeeId}`);
                const data = await response.json();

                if (data.found) {
                    document.getElementById('empName').textContent = data.name_roman || data.name_jp || '-';
                    document.getElementById('empId').textContent = `ID: ${data.employee_id}`;
                    document.getElementById('empDispatch').textContent = data.dispatch || '-';
                    document.getElementById('empRecords').textContent = data.records || 0;
                    document.getElementById('empPeriods').textContent = data.periods ? data.periods.slice(0, 3).join(', ') : '-';
                    document.getElementById('empKana').textContent = data.name_jp || '-';
                    document.getElementById('empRoman').textContent = data.name_roman || '-';

                    document.getElementById('employeeResult').classList.remove('hidden');
                    document.getElementById('employeeNotFound').classList.add('hidden');
                    
                    showNotification('‚úÖ Empleado encontrado', 'success');
                } else {
                    document.getElementById('employeeNotFound').classList.remove('hidden');
                    document.getElementById('employeeResult').classList.add('hidden');
                    showNotification('Empleado no encontrado', 'error');
                }
            } catch (error) {
                console.error('Error:', error);
                showNotification('Error al buscar empleado', 'error');
            }
        }

        function generateChingin() {
            const employeeId = document.getElementById('employeeIdInput').value.trim();
            if (!employeeId) {
                showNotification('Por favor busca un empleado primero', 'error');
                return;
            }
            const year = document.getElementById('yearSelect').value;
            showNotification('üì• Generando Ë≥ÉÈáëÂè∞Â∏≥...', 'info');
            window.location.href = `/api/employee/${employeeId}/chingin?year=${year}`;
        }

        function previewChingin() {
            const employeeId = document.getElementById('employeeIdInput').value.trim();
            if (!employeeId) {
                showNotification('Por favor busca un empleado primero', 'error');
                return;
            }
            showNotification('üëÅÔ∏è Cargando vista previa...', 'info');
            // Implementation for preview would go here
        }

        function clearAllData() {
            if (confirm('‚ö†Ô∏è ¬øEst√°s seguro de que quieres borrar TODOS los datos?')) {
                showNotification('üóëÔ∏è Borrando todos los datos...', 'info');
                // Implementation would go here
            }
        }

        function createBackup() {
            showNotification('üíæ Creando backup...', 'info');
            // Implementation would go here
        }

        function loadAudit() {
            showNotification('üìã Cargando auditor√≠a...', 'info');
            // Implementation would go here
        }

        async function loadSettings() {
            try {
                const response = await fetch('/api/settings');
                const settings = await response.json();

                const settingsList = document.getElementById('settingsList');
                settingsList.innerHTML = Object.entries(settings).map(([key, data]) => `
                    <div class="glass-morphism rounded-xl p-6">
                        <div class="flex items-center justify-between">
                            <div class="flex-1">
                                <p class="text-white font-semibold mb-1">${key}</p>
                                <p class="text-white/70 text-sm">${data.description || 'Sin descripci√≥n'}</p>
                            </div>
                            <input type="text" value="${data.value}"
                                   onchange="updateSetting('${key}', this.value)"
                                   class="bg-white/10 border border-white/20 rounded-xl px-4 py-2 text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-300 w-48 ml-4">
                        </div>
                    </div>
                `).join('');

                showNotification('‚úÖ Configuraci√≥n cargada', 'success');
            } catch (error) {
                console.error('Error loading settings:', error);
                showNotification('Error al cargar configuraci√≥n', 'error');
            }
        }

        async function updateSetting(key, value) {
            try {
                await fetch(`/api/settings/${key}?value=${encodeURIComponent(value)}`, { method: 'POST' });
                showNotification(`‚úÖ Configuraci√≥n "${key}" actualizada`, 'success');
            } catch (error) {
                console.error('Error updating setting:', error);
                showNotification('Error al actualizar configuraci√≥n', 'error');
            }
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            loadStats();

            // Inicializar AOS (Animate On Scroll)
            AOS.init({
                duration: 800,
                easing: 'ease-out-cubic',
                once: true,
                offset: 50
            });

            // Crear part√≠culas flotantes
            createParticles();

            // Efecto de typing en el t√≠tulo
            animateNumbers();

            showNotification('üöÄ Ë≥ÉÈáëÂè∞Â∏≥ Generator v4.1 PRO listo', 'success');
        });

        // Crear part√≠culas decorativas
        function createParticles() {
            const particlesContainer = document.getElementById('particles');
            const colors = ['#2563eb', '#1e40af', '#3b82f6', '#06b6d4', '#22c55e'];

            for (let i = 0; i < 15; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.cssText = `
                    left: ${Math.random() * 100}%;
                    width: ${Math.random() * 10 + 5}px;
                    height: ${Math.random() * 10 + 5}px;
                    background: ${colors[Math.floor(Math.random() * colors.length)]};
                    border-radius: 50%;
                    animation-delay: ${Math.random() * 20}s;
                    animation-duration: ${Math.random() * 15 + 15}s;
                `;
                particlesContainer.appendChild(particle);
            }
        }

        // Animar n√∫meros con efecto de conteo
        function animateNumbers() {
            const counters = document.querySelectorAll('[id^="stat"]');
            counters.forEach(counter => {
                const target = parseInt(counter.textContent.replace(/[^0-9]/g, '')) || 0;
                if (target > 0) {
                    animateValue(counter, 0, target, 1500);
                }
            });
        }

        function animateValue(element, start, end, duration) {
            const startTime = performance.now();
            const prefix = element.textContent.includes('¬•') ? '¬•' : '';

            function update(currentTime) {
                const elapsed = currentTime - startTime;
                const progress = Math.min(elapsed / duration, 1);
                const easeProgress = 1 - Math.pow(1 - progress, 3);
                const current = Math.floor(start + (end - start) * easeProgress);
                element.textContent = prefix + current.toLocaleString();

                if (progress < 1) {
                    requestAnimationFrame(update);
                }
            }
            requestAnimationFrame(update);
        }

        // Efecto confetti para celebraciones
        function triggerConfetti() {
            const colors = ['#2563eb', '#1e40af', '#3b82f6', '#22c55e', '#f97316'];
            for (let i = 0; i < 50; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.cssText = `
                    left: ${Math.random() * 100}%;
                    top: -10px;
                    width: ${Math.random() * 10 + 5}px;
                    height: ${Math.random() * 10 + 5}px;
                    background: ${colors[Math.floor(Math.random() * colors.length)]};
                    border-radius: ${Math.random() > 0.5 ? '50%' : '0'};
                    animation: confettiFall ${Math.random() * 2 + 2}s linear forwards;
                `;
                document.body.appendChild(confetti);
                setTimeout(() => confetti.remove(), 4000);
            }
        }

        // A√±adir estilos de confetti din√°micamente
        const confettiStyle = document.createElement('style');
        confettiStyle.textContent = `
            @keyframes confettiFall {
                0% { transform: translateY(0) rotate(0deg); opacity: 1; }
                100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
            }
        `;
        document.head.appendChild(confettiStyle);
    </script>
    
    <!-- Theme Selector -->
    <div id="themeSelector" class="fixed bottom-6 right-6 z-50 glass-morphism rounded-2xl p-4 border border-white/20">
        <div class="flex items-center gap-3 mb-3">
            <i class="fas fa-palette text-white text-lg"></i>
            <span class="text-white font-medium">Tema de Interfaz</span>
        </div>
        <div class="flex gap-2">
            <button onclick="setTheme('moderno')" id="btnModerno" class="theme-btn active px-4 py-2 rounded-xl text-sm font-medium transition-all duration-300 flex items-center gap-2">
                <i class="fas fa-rocket"></i>
                Moderno
            </button>
            <button onclick="setTheme('clasico')" id="btnClasico" class="theme-btn px-4 py-2 rounded-xl text-sm font-medium transition-all duration-300 flex items-center gap-2">
                <i class="fas fa-desktop"></i>
                Cl√°sico
            </button>
        </div>
        <div class="mt-3 text-white/80 text-xs">
            <i class="fas fa-info-circle"></i>
            Ctrl+Shift+T para mostrar/ocultar
        </div>
    </div>

    <style>
    .theme-btn {
        background: rgba(255, 255, 255, 0.1);
        color: rgba(255, 255, 255, 0.7);
        border: 1px solid rgba(255, 255, 255, 0.2);
    }

    .theme-btn:hover {
        background: rgba(255, 255, 255, 0.2);
        color: rgba(255, 255, 255, 0.9);
        transform: translateY(-1px);
    }

    .theme-btn.active {
        background: linear-gradient(135deg, #2563eb 0%, #1e40af 100%);
        color: white;
        border-color: transparent;
    }

    #themeSelector {
        transform: translateY(100px);
        opacity: 0;
        transition: all 0.3s ease;
    }

    #themeSelector.show {
        transform: translateY(0);
        opacity: 1;
    }
    </style>

    <script>
    function setTheme(theme) {
        // Actualizar botones
        document.querySelectorAll('.theme-btn').forEach(btn => btn.classList.remove('active'));
        
        if (theme === 'moderno') {
            document.getElementById('btnModerno').classList.add('active');
            localStorage.setItem('chingin-theme', 'moderno');
        } else {
            document.getElementById('btnClasico').classList.add('active');
            localStorage.setItem('chingin-theme', 'clasico');
        }
        
        // Redirigir al tema seleccionado
        window.location.href = `/theme/${theme}`;
    }

    // Toggle selector con Ctrl+Shift+T
    let selectorVisible = false;
    document.addEventListener('keydown', (e) => {
        if (e.ctrlKey && e.shiftKey && e.key === 'T') {
            e.preventDefault();
            selectorVisible = !selectorVisible;
            const selector = document.getElementById('themeSelector');
            if (selectorVisible) {
                selector.classList.add('show');
            } else {
                selector.classList.remove('show');
            }
        }
    });

    // Mostrar selector temporalmente al cargar
    document.addEventListener('DOMContentLoaded', () => {
        const savedTheme = localStorage.getItem('chingin-theme') || 'moderno';
        
        // Actualizar bot√≥n activo seg√∫n tema guardado
        if (savedTheme === 'moderno') {
            document.getElementById('btnModerno').classList.add('active');
        } else {
            document.getElementById('btnClasico').classList.add('active');
        }
        
        // Mostrar selector brevemente
        setTimeout(() => {
            document.getElementById('themeSelector').classList.add('show');
            setTimeout(() => {
                document.getElementById('themeSelector').classList.remove('show');
            }, 4000);
        }, 1500);
    });
    </script>
</body>
</html>